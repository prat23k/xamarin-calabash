machine:

        dependencies:
          override:
             - gem install calabash-android
             -  ./run.rb android
             - cp unsigned.apk calabash.apk
             - calabash-android resign "`pwd`/atlas.apk"
             - calabash-android run "`pwd`/atlas.apk" --format junit --out /tmp/junit
             - cp unsigned.apk $CIRCLE_ARTIFACTS
             - cp *.png $CIRCLE_ARTIFACTS
             - cp /tmp/junit/* $CIRCLE_TEST_REPORTS
             - adb logcat -d > $CIRCLE_ARTIFACTS/logcat.txt

test:
          pre:
            - emulator -avd circleci-android21 -no-audio -no-window:
                background: true
                parallel: true
            - circle-android wait-for-boot
            - sleep 5
            - adb shell input keyevent 82
            - sleep 5
            - adb shell input touchscreen swipe 370 735 371 735
            - sleep 5
            - adb shell input touchscreen swipe 370 735 371 735
            - sleep 5
          post:
            - bundle exec cucumber